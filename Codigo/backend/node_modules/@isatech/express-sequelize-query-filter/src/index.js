const InvalidRequestFilterError = require("./invalid-request-filter-error");

module.exports = (options = { alwaysCreate: true }) => {
    return (req, res, next) => {
        if(req.query.filter){
            try {
                 req.filter = JSON.parse(req.query.filter);
            } catch (error) {
                throw new InvalidRequestFilterError('Invalid query filter request');
            }
        }
        else{
            if(options.alwaysCreate == true){
                req.filter = {};
            }
        }
        next();
    }
}